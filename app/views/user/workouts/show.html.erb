<div class="container">
  <div class="row orange-border">
    <div class="col-sm-12 col-md-7">
      <h2><%= @workout.starting_date_no_time %></h2>
      <h4>Started At: <%= @workout.starting_time_only %></h4>
      <h4>Distance: <%= @workout.distance_in_miles %> miles</h4>
      <h4>Elapsed Time: <%= @workout.elapsed_time_in_minutes %> minutes</h4>
      <h4>Temperature: <%= @workout.display_temperature %></h4>
      <h4>Calories Burned: <%= @workout.calories_burned_in_kcal %> kcal</h4>
      <h4>Average Speed: <%= @workout.average_speed_in_mph %> mph</h4>
      <h4>Minimum Speed: <%= @time_series.min_speed_in_mph %> mph</h4>
      <h4>Maximum Speed: <%= @time_series.max_speed_in_mph %> mph</h4>
      <h4>Minimum Elevation: <%= @time_series.min_elevation_in_feet %> ft</h4>
      <h4>Maximum Elevation: <%= @time_series.max_elevation_in_feet %> ft</h4>
    </div>
    <div class="col-sm-12 col-md-5">
      <div class="google-map" id="google-map"></div>
    </div>
  </div>
</div>

<%= javascript_tag do %>
  function initMap() {
    var startLatLng = {lat: <%= @time_series.points.first.lat %>,
                       lng: <%= @time_series.points.first.lng %>};

    var endLatLng = {lat: <%= @time_series.points.last.lat %>,
                     lng: <%= @time_series.points.last.lng %>};

    var map = new google.maps.Map(document.getElementById('google-map'), {
      center: startLatLng,
      zoom: 16
    });

    var startMarker = new google.maps.Marker({
      position: startLatLng,
      map: map,
      label: "S"
    });

    var endMarker = new google.maps.Marker({
      position: endLatLng,
      map: map,
      label: "E"
    });

    var routeCoordinates = <%= @workout.route_coordinates.to_json.html_safe %>;
    var speeds = <%= @workout.speeds %>

    for (var i = 0; i < routeCoordinates.length-1; i++) {

      var color = "#64eb06";
      var routePath = new google.maps.Polyline({
        path: [routeCoordinates[i],routeCoordinates[i+1]],
        geodesic: true,
        strokeColor: color,
        strokeOpacity: 0.5,
        strokeWeight: 4,
        map: map
      });
    }
  }
<% end %>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDm1nN_vOXj6XM6U8rRNaBDAcprgDB1pkM&callback=initMap"
async defer></script>
